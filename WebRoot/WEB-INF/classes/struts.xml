<?xml version="1.0" encoding="UTF-8" ?>  
 <!DOCTYPE struts PUBLIC  
"-//Apache Software Foundation//DTD Struts Configuration 2.5//EN"  
"http://struts.apache.org/dtds/struts-2.5.dtd">  
<struts>
	<!-- /static 为存放静态资源的路径，意为不拦截对此文件夹下文件的请求 -->
	<constant name="struts.action.excludePattern" value="/static/.*?" />

    <!-- 该属性指定需要Struts2处理的请求后缀，该属性的默认值是action，即所有匹配*.action的请求都由Struts2处理。
        如果用户需要指定多个请求后缀，则多个后缀之间以英文逗号（,）隔开。
    <constant name="struts.action.extension" value="do" /> -->
    
    <!-- 设置浏览器是否缓存静态内容,默认值为true(生产环境下使用),开发阶段最好关闭 -->
    <constant name="struts.serve.static.browserCache" value="false" />
    <!-- 当struts的配置文件修改后,系统是否自动重新加载该文件,默认值为false(生产环境下使用),开发阶段最好打开 -->
    <constant name="struts.configuration.xml.reload" value="true" />
    <!-- 开发模式下使用,这样可以打印出更详细的错误信息 -->
    <constant name="struts.devMode" value="true" />
    <!-- 默认的视图主题 -->
    <!-- <constant name="struts.ui.theme" value="simple" /> -->
    <!-- <constant name="struts.objectFactory" value="spring" />  -->
  <package name="interce" extends="json-default">
  	<interceptors>
  		<interceptor name="adminLogin" class="com.zzy.interceptor.AdminInterceptor"></interceptor>
  		<interceptor-stack name="loginStack">
  			<interceptor-ref name="defaultStack"/>
  			<interceptor-ref name="adminLogin"/>  			
  		</interceptor-stack>
  	</interceptors>
  </package>
  <package name="news" extends="json-default,interce" namespace="/news">
  	
  	<!-- 新闻Action -->
    <action name="*" class="com.zzy.action.NewsAction" method="{1}">
    	<result name="addNView">/WEB-INF/NewsPage/addNews.jsp</result>
  		<result name="listNView">/WEB-INF/NewsPage/listNews.jsp</result>
    	<result name="addnews" type="json">    <!-- 添加 -->
                <param name="root">message</param>
       	</result>
    	<result name="pageJson" type="json">    <!-- 获取分页 -->
    		<param name="root">pageJson</param>
    	</result>
    	<result name="go_update">/WEB-INF/NewsPage/updateNews.jsp</result>   	<!-- 更新跳转 -->
    	<result type="json" name="update_success">   	<!-- 更新新闻 -->
			<param name="root">message</param>
		</result>
    	<result type="json" name="delNews">	<!-- 删除新闻 -->
    		<param name="root">status</param>
    	</result>
    	<result type="redirect" name="login">/login.jsp</result>
    <!-- 对应方法 -->
    <interceptor-ref name="loginStack"/>
    <allowed-methods>addNews,listNews,goUpdate,updateNews,delNews,go_addN,go_listN</allowed-methods>
    </action>
  </package>  
  
  <!-- 分类Action -->
  <package name="category" extends="json-default,interce"  namespace="/category">
  	<action name="*" class="com.zzy.action.CategoryAction" method="{1}">
  		<result name="addCView">/WEB-INF/CategoryPage/addCategory.jsp</result>
  		<result name="listCView">/WEB-INF/CategoryPage/listCategory.jsp</result>
  		<result name="addCategory" type="json"><!-- 添加类型 -->
  			<param name="root">message</param>
  		</result>
  		<result name="pageC" type="json"><!-- 获取类型分页 -->
  			<param name="root">pageC</param>
  		</result>
    	<result name="go_Update">/WEB-INF/CategoryPage/updateCategory.jsp</result><!-- 更新跳转 -->
    	<result type="json" name="update_success"><!-- 更新操作 -->
			<param name="root">message</param>
		</result>
    	<result type="json" name="delCategory"><!-- 删除分类 -->
    		<param name="root">status</param>
    	</result>
    	<result type="redirect" name="login">/login.jsp</result>
    <interceptor-ref name="loginStack"/>
    	<allowed-methods>addCategory,pageCategory,goUpdate,updateCategory,delCategory,go_addC,go_listC</allowed-methods>
    </action>
  </package>
  
  <!-- 登录Action -->
  <package name="login" extends="json-default,interce" namespace="/login">
  	<action name="loginAction" class="com.zzy.action.LoginAction" method="login">
  		<result name="success" type="redirectAction">index</result>
  		<result name="login">/login.jsp</result>
  	</action>
  	<action name="index" class="com.zzy.action.NewsAction" method="go_index">
  		<result name="index" type="dispatcher">/WEB-INF/cmsIndex.jsp</result>
  	</action>
  </package>
  
  <!-- 图片Action -->
  <package name="imgUpload" extends="json-default,interce" namespace="/upload">
  	<action name="uploadNewsImg" class="com.zzy.action.ImageAction" method="uploadNewsImg">
  		<result name="uploadNewsImg" type="json">
  			<param name="root">imgJson</param>
  		</result>
  		<result name="login">/login.jsp</result>
  		<interceptor-ref name="loginStack"/>
  		<interceptor-ref name="fileUpload">
    		<param name="allowedTypes">
    			image/bmp,image/png,image/gif,image/jpeg,image/jpg,image/pjpeg ,image/bmp, image/gif, image/x-png
    			</param>
    		<param name="maximumSize">1027*1027*3</param>
    	</interceptor-ref>
    	<interceptor-ref name="defaultStack"/>
  	</action>
  </package>
</struts>